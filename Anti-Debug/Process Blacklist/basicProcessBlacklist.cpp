#include <cstdio>
#include <windows.h>
#include <tlhelp32.h>
#include <iostream>


int main(int, char* [])
{
    const wchar_t* blacklist[] = { L"ida.exe",L"ida64.exe",L"x32.exe",L"x64.exe",L"procmon.exe",L"process hacker.exe",L"process explorer.exe" };
    int size = 7;
    
    
    PROCESSENTRY32 entry;
    entry.dwSize = sizeof(PROCESSENTRY32);

    HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);

    if (Process32First(snapshot, &entry) == TRUE)
    {
        do 
        {
            int i{ 0 };

            while (i < size) {
                if (wcscmp(entry.szExeFile, blacklist[i]) == 0)
                {
                    printf("Debug mode detected");
                    goto exit;
                }
                i++;
            }
        } while (Process32Next(snapshot, &entry) == TRUE);

        printf("No debuger detected");

    }

exit:
    CloseHandle(snapshot);

    return 0;
}